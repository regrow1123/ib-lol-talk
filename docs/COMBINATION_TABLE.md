# 조합표 설계 (Combination Table)

## 설계 철학

**확률 0. 의도 대 의도. 순수 읽기 싸움.**

플레이어는 그리드 좌표를 보지 못한다. "무엇을 하고 싶은가"를 선택한다.
엔진이 그리드 위에서 좌표를 계산하고, 양쪽 의도의 조합으로 결과를 결정한다.

---

## 의도 분류

### 포지셔닝 의도 (이동)

| ID | 한국어 | 설명 | 그리드 동작 |
|----|--------|------|-------------|
| PRESS | 압박 진입 | 적 스킬 사거리 안으로 전진 | 적 방향으로 접근 |
| HARASS_POS | 견제 위치 | 내 스킬 최대 사거리 끝에서 유지 | Q 사거리 경계 유지 |
| CS_SAFE | 미니언 뒤 CS | 미니언 뒤에서 막타 | 미니언 뒤쪽 고정 |
| CS_PUSH | 미니언 밀기 | 미니언에 스킬/AA | 미니언 근처 고정 |
| RETREAT | 후퇴 | 타워 쪽으로 빠짐 | 아군 타워 방향 이동 |
| BUSH_IN | 부쉬 진입 | 가까운 부쉬로 이동 | 부쉬 영역 좌표 이동 |
| BUSH_OUT | 부쉬 탈출 | 레인으로 복귀 | 레인 도로 좌표 이동 |
| ALL_IN | 올인 | 적에게 돌진 | 적 근접 사거리까지 접근 |
| MV_DODGE | 회피 기동 | 옆으로 빠짐 | Y축 이동 (회피) |

### 공격 의도 (스킬/AA)

| ID | 한국어 | 조건 |
|----|--------|------|
| Q1_CAST | 음파 발사 | 기력 50+, Q 쿨 0, 적 Q사거리(24칸) 내 |
| Q2_CAST | 공명타 돌진 | Q1 적중 마크 상태 |
| W1_SELF | 방호 (셀프) | 기력 50+, W 쿨 0 |
| W1_MINION | 방호 (미니언 돌진) | W 쿨 0, 근처 아군 미니언 |
| W2_CAST | 철갑 (생흡) | W1 사용 후 |
| E1_CAST | 폭풍 | 기력 50+, E 쿨 0, 적 E범위(9칸) 내 |
| E2_CAST | 쇠약 (둔화) | E1 적중 마크 상태 |
| R_CAST | 용의 분노 | R 쿨 0, 적 R사거리(8칸) 내 |
| AA_CHAMP | 기본공격 (챔피언) | 적 AA사거리(3칸) 내 |

### 전략 의도

| ID | 한국어 | 조건 |
|----|--------|------|
| RECALL | 귀환 | 귀환권 남음, 아군 타워 근처 |
| FLASH | 점멸 | 쿨 가능 |
| IGNITE | 점화 | 쿨 가능, 적 인접 거리 |
| POTION | 포션 | 포션 보유 |

---

## 의도 조합: 적중/회피 판정

### 원칙
1. **양쪽 의도를 동시에 공개** → 조합으로 결과 결정
2. **공격 중에는 위치 고정** — 공격하면서 동시에 회피할 수 없음
3. **미니언 뒤에 있으면 Q 차단** — 그리드 상 미니언-챔피언 위치 관계로 판정
4. **부쉬 = 시야 상실** — 어떤 대상지정 공격이든 불가

---

### Q1 (음파) 적중 판정

Q는 직선 투사체 → 미니언에 막힘. 적의 **위치 상태**가 핵심.

| 적 의도 | 적중 | 이유 |
|---------|------|------|
| CS_SAFE | ❌ | 미니언 뒤에 있음 → 투사체 차단 |
| CS_PUSH | ❌ | 미니언 사이에 있음 → 차단 가능성 높음 |
| PRESS | ✅ | 미니언 앞으로 나옴 → 노출 |
| HARASS_POS | ⚠️ | 미니언 라인 밖이면 ✅, 뒤면 ❌ |
| ALL_IN | ✅ | 달려오는 중 → 노출 |
| AA_CHAMP | ✅ | 근접 사거리에서 서있음 |
| Q1_CAST (맞교환) | ✅ | 공격 중 위치 고정 → 노출 |
| E1_CAST (맞교환) | ✅ | 공격 중 위치 고정 |
| RETREAT | ⚠️ | 사거리 밖으로 빠지면 ❌, 안이면 ✅ |
| MV_DODGE | ❌ | 옆으로 빠져서 회피 |
| BUSH_IN | ❌ | 시야 상실 + 위치 이탈 |
| FLASH | ❌ | 즉시 이동 |
| W1_MINION | ❌ | 미니언으로 돌진 → 위치 이탈 |

**⚠️ 조건부 판정**: 그리드 좌표로 정확히 계산.
- HARASS_POS: 적의 x좌표가 미니언 라인 앞인지 뒤인지
- RETREAT: 후퇴 후에도 Q 사거리(24칸) 안인지

---

### E1 (폭풍) 적중 판정

E는 자기 주변 원형 범위 (반경 9칸). **범위 안에 있으면 적중.**

| 적 의도 | 적중 | 이유 |
|---------|------|------|
| 인접에서 CS/AA/PRESS/ALL_IN | ✅ | 범위 안 |
| 인접에서 MV_DODGE | ⚠️ | 옆 이동이지만 범위가 넓어 여전히 안에 있을 수 있음 |
| RETREAT | ⚠️ | 이미 범위 경계면 탈출 가능 |
| BUSH_IN | ❌ | 범위 밖으로 이탈 |
| FLASH | ❌ | 즉시 범위 밖 |
| W1_MINION (뒤로) | ❌ | 사거리 밖 이탈 |

**E는 Q보다 회피 어려움** — 미니언 차단 없고, 범위가 넓음.
단, 사거리가 짧아서(9칸) 가까이 가야 쓸 수 있음.

---

### AA / R / 점화 (대상지정) 적중 판정

대상지정 = 사거리 안이면 기본 적중. 회피 수단이 제한적.

| 적 의도 | 적중 | 이유 |
|---------|------|------|
| 사거리 내 아무 행동 | ✅ | 대상지정은 자동 적중 |
| RETREAT (사거리 밖으로) | ❌ | 사거리 이탈 |
| BUSH_IN | ❌ | 시야 상실 |
| FLASH | ❌ | 즉시 이탈 |
| W1_MINION (사거리 밖으로) | ❌ | 위치 이탈 |

---

### 맞교환 (양쪽 공격)

**공격 = 위치 고정.** 양쪽 다 공격하면:
- 둘 다 적중 조건 만족 → **둘 다 맞음**
- Q를 쏘면서 상대 Q를 피할 수 없음
- 맞교환에서는 **피해 효율**이 중요 (누가 더 아프게 맞는가)

| 상황 | 나 | 적 | 결과 |
|------|----|----|------|
| Q 맞교환 | Q1 (미니언 앞) | Q1 (미니언 앞) | 둘 다 ✅ |
| Q vs AA | Q1 | AA (근접) | Q ✅, AA ✅ |
| Q vs E | Q1 | E1 (근접) | Q ✅ (노출), E ❌ (Q 사거리 > E 범위) |
| E vs AA | E1 | AA | 둘 다 ✅ (인접 거리) |
| 일방 공격 | Q1 (제자리 겨냥) | RETREAT | Q ⚠️ (거리 따라), 적 안전 |

---

### CS 트레이드오프

핵심 긴장감: **CS를 먹을 것인가 vs 회피할 것인가**

| 나 | 적 | 결과 |
|----|----|------|
| CS_SAFE | Q1 | ❌ Q 차단 (미니언 뒤) + CS 성공 ✅ |
| CS_SAFE | E1 (인접) | E ✅ 적중 + CS 성공 ✅ |
| CS_SAFE | AA | AA ✅ 적중 + CS 성공 ✅ |
| PRESS | 적 CS_SAFE | 위치 이득, 압박 성공 |
| MV_DODGE | Q1 | Q ❌ 빗나감, CS 놓침 ❌ |

- CS_SAFE는 **Q에 안전하지만 E/AA에 취약**
- 회피하면 CS 놓침 → CS 격차 벌어짐
- 앞으로 나가면 Q 맞을 수 있지만 적에게 압박 가능

---

## 특수 의도 규칙

### Q2 (공명타 돌진)
- Q1 적중 마크가 있을 때만 사용 가능
- **무조건 적중** (마크 된 대상에게 돌진)
- 사용 후 **적과 인접** 상태가 됨

### W1 (방호)
- **셀프 쉴드**: 제자리에서 쉴드 + 다른 행동과 결합 가능
- **미니언 돌진**: 아군 미니언 위치로 이동 → 위치 변경 효과
  - 회피 수단으로 사용 가능 (갑자기 위치 변경)

### R (용의 분노)
- 대상지정이지만 사거리가 짧음 (8칸 = 인접)
- 적중 시 **넉백** → 적을 뒤로 밀어냄 (그리드 16칸)
- 타워 방향으로 차면 타워 사거리 안으로 밀어넣기 가능

### RECALL (귀환)
- 아군 타워 근처에서만 사용 가능
- 적이 **비공격** 의도 → 귀환 성공
- 적이 **공격** 의도 (닿을 수 있다면) → 귀환 취소
- 귀환 중 적은 자유롭게 CS/타워 공격

---

## 부쉬 규칙

1. **부쉬 진입** → 상대 시야에서 사라짐
2. **부쉬에서 공격** → 상대가 대응 선택 전에 피해 (기습 보너스?)
3. **양쪽 같은 부쉬** → 서로 보임, 일반 교전
4. **부쉬에 있으면 CS 불가** (미니언 라인에서 벗어남)
5. Q로 부쉬 안 적 감지 가능 (Q 적중 시 시야 제공)

---

## 선택지 한국어 표현 예시

### 공격 의도

```
"적이 미니언 앞에 서있을 거라 보고 Q를 날린다"           → Q1 + 적 PRESS/AA 예측
"미니언을 무시하고 앞으로 걸어가서 E를 건다"             → ALL_IN + E1
"기본공격으로 적을 한 대 친다"                          → AA_CHAMP
"Q 마크가 남아있다 — 돌진해서 들어간다"                  → Q2_CAST
```

### 포지셔닝 의도

```
"미니언 막타를 챙기며 미니언 뒤에서 버틴다"              → CS_SAFE
"대담하게 미니언 앞으로 걸어가 압박한다"                 → PRESS
"적의 스킬이 올 것 같아 옆으로 몸을 뺀다"               → MV_DODGE
"부쉬 쪽으로 빠져서 시야를 끊는다"                      → BUSH_IN
"안전하게 타워 쪽으로 한 발 뺀다"                       → RETREAT
```

### 복합 의도 (공격 + 포지셔닝)

```
"앞으로 걸어가면서 E를 건다"                            → PRESS + E1
"Q를 날리고 뒤로 빠진다"                               → Q1 + RETREAT (다음 턴)
"미니언 뒤에서 CS 먹으면서 W 쉴드를 켠다"               → CS_SAFE + W1_SELF
```

---

## 그리드 좌표 ↔ 의도 매핑 (엔진 내부)

### 의도별 좌표 변경 규칙

| 의도 | X 변화 | Y 변화 | 비고 |
|------|--------|--------|------|
| PRESS | 적 방향 +8~12 | 0 | 적 스킬 사거리 안으로 |
| HARASS_POS | Q 사거리 끝으로 조정 | 0 | 적과 ~24칸 거리 유지 |
| CS_SAFE | 미니언 뒤 위치로 | 0 | 미니언 x좌표 - 3~5 |
| CS_PUSH | 미니언 위치로 | 0 | 미니언 x좌표 근처 |
| RETREAT | 아군 타워 방향 -15~20 | 0 | 최대 이동 |
| BUSH_IN | 부쉬 x로 | 부쉬 y로 | 가까운 부쉬 |
| BUSH_OUT | 레인 x로 | 12 (중앙) | 레인 복귀 |
| ALL_IN | 적 x - 3 | 적 y | 근접 사거리 |
| MV_DODGE | 0 | ±4~6 | Y축 회피 |
| 공격 행동 | 0 | 0 | 위치 고정 |
