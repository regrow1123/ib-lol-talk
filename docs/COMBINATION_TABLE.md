# 조합표 설계 (Combination Table)

## 행동 분류

모든 선택지는 아래 행동 타입 중 하나에 매핑된다.

### 공격 행동
| ID | 행동 | 조건 |
|----|------|------|
| Q1 | 음파 발사 | 기력 50+, Q 쿨 가능, 거리 2칸 이내 |
| Q2 | 공명타 (돌진) | Q1 적중 후에만 사용 가능 |
| W1 | 방호 (쉴드) | 기력 50+, W 쿨 가능 |
| W2 | 철갑 (생흡) | W1 사용 후에만 |
| E1 | 폭풍 (범위) | 기력 50+, E 쿨 가능, 인접 거리 |
| E2 | 쇠약 (둔화) | E1 사용 후에만 |
| R | 용의 분노 | R 쿨 가능, 인접 거리 |
| AA_CHAMP | 기본공격 (챔피언) | 인접 거리 |

### CS 행동
| ID | 행동 | 조건 |
|----|------|------|
| CS | 미니언 막타 | 막타 가능한 미니언 존재 |
| CS_PUSH | 미니언 밀기 (스킬+AA) | 미니언 웨이브 존재 |

### 이동 행동
| ID | 행동 | 조건 |
|----|------|------|
| MV_FWD | 앞으로 이동 | 적 타워 안이 아닐 때 |
| MV_BACK | 뒤로 이동 | 아군 타워 뒤가 아닐 때 |
| MV_BUSH | 부쉬 진입 | 부쉬에 없을 때 |
| MV_OUT_BUSH | 부쉬에서 나옴 | 부쉬에 있을 때 |
| MV_DODGE | 옆으로 회피 기동 | 항상 가능 |

### 방어/전략 행동
| ID | 행동 | 조건 |
|----|------|------|
| RECALL | 귀환 시작 | 귀환권 남아있을 때 |
| FLASH | 점멸 | 쿨 가능 |
| IGNITE | 점화 | 쿨 가능, 인접 거리 |
| POTION | 포션 사용 | 포션 보유 |

---

## 거리 시스템

```
[아군타워(0)] --- [아군쪽(1)] --- [중앙(2)] --- [적쪽(3)] --- [적타워(4)]
```

- **인접 (거리 0-1칸 차이)**: AA, E, R, 점화 가능
- **중거리 (거리 1-2칸 차이)**: Q 가능
- **원거리 (거리 3칸+)**: 스킬 불가
- **부쉬**: 중앙(2) 위치에서 진입 가능한 별도 공간. 부쉬 안의 상대는 타겟팅 불가.

---

## 핵심 조합표: 방향 예측 시스템

### 핵심 원칙
**모든 행동에는 의도(방향/위치 예측)가 포함된다.**
공격자는 "어디를 노릴지", 수비자는 "어디로 갈지"를 선택.
예측이 맞으면 적중, 틀리면 빗나감.

---

### 위치 그리드 (한 상황 내 미시 위치)

레인 위의 매 상황에서 챔피언이 취할 수 있는 미시 위치:

```
        [뒤쪽]
          |
[왼쪽] — [제자리] — [오른쪽]
          |
        [앞쪽]
```

추가로: [부쉬] (옆 공간)

---

### 스킬샷 (Q 등) 조합표

공격자: 어디를 겨냥해서 쏘는지
수비자: 어디로 움직이는지

| 공격 겨냥 \ 적 이동 | 제자리 (CS 등) | 왼쪽 | 오른쪽 | 뒤쪽 | 앞쪽 | 부쉬 |
|---------------------|---------------|------|--------|------|------|------|
| 제자리 겨냥 | ✅ 적중 | ❌ | ❌ | ❌ | ❌ | ❌ |
| 왼쪽 겨냥 | ❌ | ✅ 적중 | ❌ | ❌ | ❌ | ❌ |
| 오른쪽 겨냥 | ❌ | ❌ | ✅ 적중 | ❌ | ❌ | ❌ |
| 뒤쪽 겨냥 | ❌ | ❌ | ❌ | ✅ 적중 | ❌ | ❌ |
| 앞쪽 겨냥 | ❌ | ❌ | ❌ | ❌ | ✅ 적중 | ❌ |

**부쉬로 이동하면 시야가 사라지므로 어떤 겨냥이든 빗나감.**

---

### 기본공격 / 대상지정 스킬 (AA, R, 점화 등)

대상지정 스킬은 스킬샷보다 회피 선택지가 적다:
- **점멸**: 무조건 회피
- **부쉬 진입**: 시야 상실로 회피
- **뒤로 빠지기**: 사거리 밖이면 회피 (인접 거리에서만)
- **그 외 이동**: 회피 불가 (대상지정이므로)

| 공격 | 적 행동 | 결과 |
|------|---------|------|
| AA/R/점화 | 제자리/CS/앞으로/왼/오 | ✅ 적중 (대상지정) |
| AA/R/점화 | 뒤로 | 거리에 따라 (인접→회피 가능, 밀착→적중) |
| AA/R/점화 | 부쉬 | ❌ 시야 상실 |
| AA/R/점화 | 점멸 | ❌ 점멸 회피 |

---

### 범위기 (E 등)

E는 자기 주변 범위 공격. 인접한 적에게 적용.
- 인접 거리에서: **왼쪽/오른쪽 이동으로는 회피 불가** (범위 안)
- **뒤쪽으로 빠지면**: 범위 밖 → 회피
- **앞으로 오면**: 범위 안 → 적중
- **부쉬/점멸**: 회피

---

### 맞교환 상황

양쪽 다 공격을 선택한 경우:

| 내 행동 | 적 행동 | 결과 |
|---------|---------|------|
| Q(제자리 겨냥) + 적이 AA | 적은 제자리 → Q 적중 + AA도 적중 | 맞교환 |
| Q(왼쪽 겨냥) + 적이 Q(제자리 겨냥) | 내가 제자리 → 적Q 적중, 적이 제자리 → 내Q 빗나감(왼쪽 겨냥) | 일방적 손해 |

→ **공격하면서 움직이지 않기 때문에** 공격 중에는 자신도 맞을 수 있다.
→ 양쪽 다 공격할 때, 겨냥 방향이 핵심.

---

### 선택지 자연어 예시

**공격 의도가 담긴 선택지:**
```
1. "적이 CS를 포기 못할 거라 보고, 미니언 앞 그 자리에 Q를 날린다"
2. "적이 왼쪽으로 빠질 것 같아서, 왼쪽을 겨냥해 Q를 날린다"  
3. "적이 뒤로 물러날 걸 예상하고, 살짝 뒤를 노려 Q를 쏜다"
4. "적이 앞으로 덤빌 것 같아서, 오히려 코앞을 겨냥해 Q를 날린다"
```

**이동 의도가 담긴 선택지:**
```
1. "미니언 막타를 챙기며 제자리를 지킨다"
2. "적의 Q가 올 것 같아 왼쪽으로 몸을 빼며 CS를 포기한다"
3. "부쉬 쪽으로 이동해 시야를 끊고 적의 판단을 흐린다"
4. "대담하게 앞으로 걸어가며 압박을 건다"
```

---

### CS와 공격의 트레이드오프

- CS를 먹으려면 미니언 앞에 **제자리**에 서야 함
- 제자리에 서면 **예측당하기 쉬움** (제자리 겨냥 공격에 맞음)
- 회피하면 CS를 **놓침**
- → 이 긴장감이 라인전의 핵심

---

### 8. 특수 상황

#### RECALL (귀환)
- 귀환 중 **어떤 피해라도** 받으면 귀환 취소
- 적이 CS / MV_BACK / MV_BUSH 등 비공격 행동이면 귀환 성공
- 귀환 성공 시: 아이템 구매 화면 → 아이템 구매 후 라인 복귀
- 귀환 중 적은 자유롭게 CS / 타워 공격 가능

| 내 행동 | 적 행동 | 결과 |
|---------|---------|------|
| RECALL | CS | ✅ 귀환 성공. 적은 CS 자유롭게 먹음 |
| RECALL | MV_FWD | ✅ 귀환 성공 (아군 타워 아래서 귀환 시) |
| RECALL | AA_CHAMP | ❌ 귀환 취소 |
| RECALL | Q1 | ❌ 귀환 취소 |
| RECALL | 모든 공격 | ❌ 귀환 취소 |

#### FLASH (점멸)
- 모든 단일 대상 공격 회피 가능
- 위치 1칸 즉시 이동 (방향 선택)
- E1 범위 안이라도 점멸로 범위 밖 탈출 가능

#### IGNITE (점화)
- 인접 거리에서만 사용
- 5턴에 걸쳐 지속 피해
- 치유량 감소 효과

---

## 회피 기동 (MV_DODGE) 규칙

회피 기동은 강력하지만 **제약**이 필요:

1. 회피 기동 시 **CS를 못 먹음** (미니언 놓침)
2. 회피 기동 시 **반격 불가** (공격 행동 불가)
3. **위치가 변하지 않음** (제자리에서 옆으로 빠지는 것)
4. 연속 회피 기동 시 페널티? (상대가 예측 가능)

→ 회피만 계속 하면 CS에서 밀려서 지게 되는 구조.

---

## 부쉬 규칙

1. 부쉬 안의 챔피언은 **상대에게 보이지 않음**
2. 부쉬에서 나오며 공격하면 **기습 효과** (상대 행동보다 우선 적용?)
3. 양쪽 다 부쉬에 들어가면 **서로 보임** (같은 부쉬)
4. 부쉬에 있으면 **CS를 못 먹음** (미니언과 거리가 있으므로)

---

## 상황 흐름 구조

```
[상황 서술] → [양쪽 선택] → [조합 결과 계산] → [결과 서술] → [상태 업데이트] → 반복
```

### 1 상황 = 약 3초 (게임 내 시간)
- 쿨타임은 "상황 수"로 환산
- Q 쿨 10초 = 약 3~4 상황
- 미니언 웨이브: 약 10상황마다 새 웨이브 도착

---

## AI 상대 설계 (초기)

### 난이도별 AI
- **쉬움**: CS 위주, 가끔 공격. 회피 기동 잘 안 함
- **보통**: 적절히 공격/CS. 위험할 때 뒤로 빠짐
- **어려움**: 조합표를 이해하고 최적 행동. 상대 패턴 읽기

### AI 선택 방식
1. 현재 상태 평가 (HP 비율, CS 차이, 레벨 차이)
2. 목표 설정 (킬 가능? CS 모으기? 안전하게?)
3. 목표에 맞는 행동 선택
4. 난이도에 따라 최적해에서 벗어나는 정도 조절
